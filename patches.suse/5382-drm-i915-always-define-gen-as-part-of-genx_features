From: Chris Wilson <chris@chris-wilson.co.uk>
Date: Thu, 15 Feb 2018 08:19:29 +0000
Subject: drm/i915: Always define GEN as part of GENx_FEATURES
Git-commit: a6e1c5ace4810342b708f3fbbd203013d4b9d22c
Patch-mainline: v4.17-rc1
References: FATE#326289 FATE#326079 FATE#326049 FATE#322398 FATE#326166

Be consistent and define the device's GEN as part of the GENx_FEATURE.
It will be overridden by the next gen upon inheriting, as per usual.

Signed-off-by: Chris Wilson <chris@chris-wilson.co.uk>
Reviewed-by: Rodrigo Vivi <rodrigo.vivi@intel.com>
Link: https://patchwork.freedesktop.org/patch/msgid/20180215081930.11477-2-chris@chris-wilson.co.uk

Acked-by: Petr Tesarik <ptesarik@suse.com>
---
 drivers/gpu/drm/i915/i915_pci.c |    8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)

--- a/drivers/gpu/drm/i915/i915_pci.c
+++ b/drivers/gpu/drm/i915/i915_pci.c
@@ -383,6 +383,7 @@ static const struct intel_device_info in
 
 #define GEN8_FEATURES \
 	G75_FEATURES, \
+	GEN(8), \
 	BDW_COLORS, \
 	.page_sizes = I915_GTT_PAGE_SIZE_4K | \
 		      I915_GTT_PAGE_SIZE_2M, \
@@ -393,7 +394,6 @@ static const struct intel_device_info in
 
 #define BDW_PLATFORM \
 	GEN8_FEATURES, \
-	GEN(8), \
 	.platform = INTEL_BROADWELL
 
 static const struct intel_device_info intel_broadwell_gt1_info = {
@@ -452,6 +452,7 @@ static const struct intel_device_info in
 
 #define GEN9_FEATURES \
 	GEN8_FEATURES, \
+	GEN(9), \
 	GEN9_DEFAULT_PAGE_SIZES, \
 	.has_logical_ring_preemption = 1, \
 	.has_csr = 1, \
@@ -461,7 +462,6 @@ static const struct intel_device_info in
 
 #define SKL_PLATFORM \
 	GEN9_FEATURES, \
-	GEN(9), \
 	.platform = INTEL_SKYLAKE
 
 static const struct intel_device_info intel_skylake_gt1_info = {
@@ -535,7 +535,6 @@ static const struct intel_device_info in
 
 #define KBL_PLATFORM \
 	GEN9_FEATURES, \
-	GEN(9),  \
 	.platform = INTEL_KABYLAKE
 
 static const struct intel_device_info intel_kabylake_gt1_info = {
@@ -556,7 +555,6 @@ static const struct intel_device_info in
 
 #define CFL_PLATFORM \
 	GEN9_FEATURES, \
-	GEN(9), \
 	.platform = INTEL_COFFEELAKE
 
 static const struct intel_device_info intel_coffeelake_gt1_info = {
@@ -577,12 +575,12 @@ static const struct intel_device_info in
 
 #define GEN10_FEATURES \
 	GEN9_FEATURES, \
+	GEN(10), \
 	.ddb_size = 1024, \
 	GLK_COLORS
 
 static const struct intel_device_info intel_cannonlake_info = {
 	GEN10_FEATURES,
-	GEN(10),
 	.platform = INTEL_CANNONLAKE,
 	.gt = 2,
 };
