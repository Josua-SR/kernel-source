From: Joerg Roedel <jroedel@suse.de>
Date: Wed, 14 Aug 2019 14:06:06 +0200
Subject: [PATCH 05/11] iommu/vt-d: Request passthrough mode from IOMMU core
Patch-mainline: v5.4-rc1
Git-commit: 6b9a7d3a466fffc97c4b133852d3dd7905510dd6
References: bsc#1136039

Get rid of the iommu_pass_through variable and request
passthrough mode via the new iommu core function.

Signed-off-by: Joerg Roedel <jroedel@suse.de>
---
 drivers/iommu/intel-iommu.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/drivers/iommu/intel-iommu.c
+++ b/drivers/iommu/intel-iommu.c
@@ -3363,7 +3363,7 @@ static int __init init_dmars(void)
 		iommu->flush.flush_iotlb(iommu, 0, 0, 0, DMA_TLB_GLOBAL_FLUSH);
 	}
 
-	if (iommu_pass_through)
+	if (iommu_default_passthrough())
 		iommu_identity_mapping |= IDENTMAP_ALL;
 
 #ifdef CONFIG_INTEL_IOMMU_BROKEN_GFX_WA
