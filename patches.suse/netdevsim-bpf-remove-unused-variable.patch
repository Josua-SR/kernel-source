From: Jakub Kicinski <jakub.kicinski@netronome.com>
Date: Tue, 19 Dec 2017 12:10:43 -0800
Subject: netdevsim: bpf: remove unused variable
Patch-mainline: v4.16-rc1
Git-commit: 40946e93b32eb923b9d968557e44725aa6cb201a
References: bsc#1109837

skip_sw is set but no longer used.

Signed-off-by: Jakub Kicinski <jakub.kicinski@netronome.com>
Reviewed-by: Quentin Monnet <quentin.monnet@netronome.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Thomas Bogendoerfer <tbogendoerfer@suse.de>
---
 drivers/net/netdevsim/bpf.c |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

--- a/drivers/net/netdevsim/bpf.c
+++ b/drivers/net/netdevsim/bpf.c
@@ -108,7 +108,6 @@ int nsim_bpf_setup_tc_block_cb(enum tc_s
 	struct bpf_prog *prog = cls_bpf->prog;
 	struct netdevsim *ns = cb_priv;
 	struct bpf_prog *oldprog;
-	bool skip_sw;
 
 	if (type != TC_SETUP_CLSBPF ||
 	    !tc_can_offload(ns->netdev) ||
@@ -116,7 +115,8 @@ int nsim_bpf_setup_tc_block_cb(enum tc_s
 	    cls_bpf->common.chain_index)
 		return -EOPNOTSUPP;
 
-	skip_sw = cls_bpf->gen_flags & TCA_CLS_FLAGS_SKIP_SW;
+	if (nsim_xdp_offload_active(ns))
+		return -EBUSY;
 
 	if (!ns->bpf_tc_accept)
 		return -EOPNOTSUPP;
