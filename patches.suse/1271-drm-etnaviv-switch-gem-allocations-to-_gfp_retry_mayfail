From: Lucas Stach <l.stach@pengutronix.de>
Date: Fri, 11 Aug 2017 11:43:17 +0200
Subject: drm/etnaviv: switch GEM allocations to __GFP_REPEAT
Git-commit: 65375b873cb553c1e52d6e0d77d954011f44433e
Patch-mainline: v4.14-rc1
References: FATE#326289 FATE#326079 FATE#326049 FATE#322398 FATE#326166

Now that we have a GFP flags with the expected semantic of "try reasonably
hard to find memory, but don't OOM", we should start to use it.

Signed-off-by: Lucas Stach <l.stach@pengutronix.de>
Acked-by: Petr Tesarik <ptesarik@suse.com>
---
 drivers/gpu/drm/etnaviv/etnaviv_gem.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/drivers/gpu/drm/etnaviv/etnaviv_gem.c
+++ b/drivers/gpu/drm/etnaviv/etnaviv_gem.c
@@ -663,7 +663,7 @@ static struct drm_gem_object *__etnaviv_
 		 */
 		mapping = obj->filp->f_mapping;
 		mapping_set_gfp_mask(mapping, GFP_HIGHUSER |
-				     __GFP_NORETRY | __GFP_NOWARN);
+				     __GFP_REPEAT | __GFP_NOWARN);
 	}
 
 	if (ret)
