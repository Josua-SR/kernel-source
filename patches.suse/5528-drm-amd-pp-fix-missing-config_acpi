From: Dave Airlie <airlied@redhat.com>
Date: Wed, 14 Mar 2018 10:54:55 +1000
Subject: drm/amd/pp: fix missing CONFIG_ACPI.
Git-commit: 62ccb6533920ce6e8a18ef7c5ee3f98783a1a42a
Patch-mainline: v4.17-rc1
References: FATE#326289 FATE#326079 FATE#326049 FATE#322398 FATE#326166

This was stopping me building on ARM after last pull.

Signed-off-by: Dave Airlie <airlied@redhat.com>
Acked-by: Petr Tesarik <ptesarik@suse.com>
---
 drivers/gpu/drm/amd/powerplay/hwmgr/smu7_hwmgr.c |    2 ++
 1 file changed, 2 insertions(+)

--- a/drivers/gpu/drm/amd/powerplay/hwmgr/smu7_hwmgr.c
+++ b/drivers/gpu/drm/amd/powerplay/hwmgr/smu7_hwmgr.c
@@ -3827,12 +3827,14 @@ static int smu7_notify_link_speed_change
 				smu7_get_current_pcie_speed(hwmgr) > 0)
 			return 0;
 
+#ifdef CONFIG_ACPI
 		if (amdgpu_acpi_pcie_performance_request(hwmgr->adev, request, false)) {
 			if (PP_PCIEGen2 == target_link_speed)
 				pr_info("PSPP request to switch to Gen2 from Gen3 Failed!");
 			else
 				pr_info("PSPP request to switch to Gen1 from Gen2 Failed!");
 		}
+#endif
 	}
 
 	return 0;
