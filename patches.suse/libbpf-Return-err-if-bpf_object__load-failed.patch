From: Mao Wenan <maowenan@huawei.com>
Date: Sun, 26 Apr 2020 14:36:35 +0800
Subject: libbpf: Return err if bpf_object__load failed
Patch-mainline: v5.8-rc1
Git-commit: e411eb257b331bf44cbe8845b5351260c8222c6c
References: bsc#1177028

bpf_object__load() has various return code, when it failed to load
object, it must return err instead of -EINVAL.

Signed-off-by: Mao Wenan <maowenan@huawei.com>
Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
Acked-by: Andrii Nakryiko <andriin@fb.com>
Link: https://lore.kernel.org/bpf/20200426063635.130680-3-maowenan@huawei.com
Acked-by: Gary Lin <glin@suse.com>
---
 tools/lib/bpf/libbpf.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/tools/lib/bpf/libbpf.c
+++ b/tools/lib/bpf/libbpf.c
@@ -7009,7 +7009,7 @@ int bpf_prog_load_xattr(const struct bpf
 	err = bpf_object__load(obj);
 	if (err) {
 		bpf_object__close(obj);
-		return -EINVAL;
+		return err;
 	}
 
 	*pobj = obj;
