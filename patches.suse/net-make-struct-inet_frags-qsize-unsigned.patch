From: Alexey Dobriyan <adobriyan@gmail.com>
Date: Tue, 23 May 2017 00:20:26 +0300
Subject: net: make struct inet_frags::qsize unsigned
Patch-mainline: v4.13-rc1
Git-commit: 4c0ebd6fed66388584abb27d7b0f188cc1ec01fe
References: CVE-2018-5391 bsc#1103097

This field is sizeof of corresponding kmem_cache so it can't be negative.

Prepare for 32-bit kmem_cache_create().

Signed-off-by: Alexey Dobriyan <adobriyan@gmail.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Michal Kubecek <mkubecek@suse.cz>

---
 include/net/inet_frag.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/include/net/inet_frag.h
+++ b/include/net/inet_frag.h
@@ -87,7 +87,7 @@ struct inet_frags {
 	 */
 	u32			rnd;
 	seqlock_t		rnd_seqlock;
-	int			qsize;
+	unsigned int		qsize;
 
 	unsigned int		(*hashfn)(const struct inet_frag_queue *);
 	bool			(*match)(const struct inet_frag_queue *q,
