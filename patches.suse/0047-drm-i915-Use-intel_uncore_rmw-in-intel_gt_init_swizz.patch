From f88709bd1c5e2bc9fb62b1b3151fae1ef4f7a2c5 Mon Sep 17 00:00:00 2001
From: Tvrtko Ursulin <tvrtko.ursulin@intel.com>
Date: Fri, 21 Jun 2019 08:07:46 +0100
Subject: drm/i915: Use intel_uncore_rmw in intel_gt_init_swizzling
Git-commit: f88709bd1c5e2bc9fb62b1b3151fae1ef4f7a2c5
Patch-mainline: v5.4-rc1
References: bsc#1152489

Two easy opportunities to compact the code by using the existing helper.

Signed-off-by: Tvrtko Ursulin <tvrtko.ursulin@intel.com>
Suggested-by: Rodrigo Vivi <rodrigo.vivi@intel.com>
Reviewed-by: Chris Wilson <chris@chris-wilson.co.uk>
Link: https://patchwork.freedesktop.org/patch/msgid/20190621070811.7006-8-tvrtko.ursulin@linux.intel.com
Acked-by: Thomas Zimmermann <tzimmermann@suse.de>
---
 drivers/gpu/drm/i915/i915_gem_fence_reg.c | 9 ++-------
 1 file changed, 2 insertions(+), 7 deletions(-)

diff --git a/drivers/gpu/drm/i915/i915_gem_fence_reg.c b/drivers/gpu/drm/i915/i915_gem_fence_reg.c
index dd09790c420d..bcac359ec661 100644
--- a/drivers/gpu/drm/i915/i915_gem_fence_reg.c
+++ b/drivers/gpu/drm/i915/i915_gem_fence_reg.c
@@ -844,17 +844,12 @@ void intel_gt_init_swizzling(struct intel_gt *gt)
 	    i915->mm.bit_6_swizzle_x == I915_BIT_6_SWIZZLE_NONE)
 		return;
 
-	intel_uncore_write(uncore,
-			   DISP_ARB_CTL,
-			   intel_uncore_read(uncore, DISP_ARB_CTL) |
-			   DISP_TILE_SURFACE_SWIZZLING);
+	intel_uncore_rmw(uncore, DISP_ARB_CTL, 0, DISP_TILE_SURFACE_SWIZZLING);
 
 	if (IS_GEN(i915, 5))
 		return;
 
-	intel_uncore_write(uncore,
-			   TILECTL,
-			   intel_uncore_read(uncore, TILECTL) | TILECTL_SWZCTL);
+	intel_uncore_rmw(uncore, TILECTL, 0, TILECTL_SWZCTL);
 
 	if (IS_GEN(i915, 6))
 		intel_uncore_write(uncore,
-- 
2.28.0

