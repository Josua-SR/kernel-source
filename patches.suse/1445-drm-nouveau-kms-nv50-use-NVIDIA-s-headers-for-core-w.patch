From 69f90a9415c2b11639699c8af552fed7c95f1b1e Mon Sep 17 00:00:00 2001
From: Ben Skeggs <bskeggs@redhat.com>
Date: Sat, 20 Jun 2020 17:59:39 +1000
Subject: drm/nouveau/kms/nv50-: use NVIDIA's headers for core wndw_owner()
Git-commit: 8e650ecbcd5d769afa03618cb4c7f4a21498ecd5
Patch-mainline: v5.9-rc1
References: jsc#SLE-12680, jsc#SLE-12880, jsc#SLE-12882, jsc#SLE-12883, jsc#SLE-13496, jsc#SLE-15322

Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
Reviewed-by: Lyude Paul <lyude@redhat.com>
Signed-off-by: Patrik Jakobsson <pjakobsson@suse.de>
---
 drivers/gpu/drm/nouveau/dispnv50/corec37d.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/drivers/gpu/drm/nouveau/dispnv50/corec37d.c b/drivers/gpu/drm/nouveau/dispnv50/corec37d.c
index 796e847ca874..9035d3ab062c 100644
--- a/drivers/gpu/drm/nouveau/dispnv50/corec37d.c
+++ b/drivers/gpu/drm/nouveau/dispnv50/corec37d.c
@@ -40,8 +40,10 @@ corec37d_wndw_owner(struct nv50_core *core)
 	if ((ret = PUSH_WAIT(push, windows * 2)))
 		return ret;
 
-	for (i = 0; i < windows; i++)
-		PUSH_NVSQ(push, NVC37D, 0x1000 + (i * 0x080), i >> 1);
+	for (i = 0; i < windows; i++) {
+		PUSH_MTHD(push, NVC37D, WINDOW_SET_CONTROL(i),
+			  NVDEF(NVC37D, WINDOW_SET_CONTROL, OWNER, HEAD(i >> 1)));
+	}
 
 	return 0;
 }
-- 
2.29.2

