From: Dave Watson <davejwatson@fb.com>
Date: Sat, 17 Jun 2017 08:25:13 -0700
Subject: tls: update Kconfig
Patch-mainline: v4.13-rc1
Git-commit: d807ec656f868c1800e38cefa98be3ec680f6a1f
References: bsc#1103990 FATE#326006

Missing crypto deps for some platforms.
Default to n for new module.

config: m68k-amcore_defconfig (attached as .config)
compiler: m68k-linux-gcc (GCC) 4.9.0

make.cross ARCH=m68k
All errors (new ones prefixed by >>):

   net/built-in.o: In function `tls_set_sw_offload':
>> (.text+0x732f8): undefined reference to `crypto_alloc_aead'
   net/built-in.o: In function `tls_set_sw_offload':
>> (.text+0x7333c): undefined reference to `crypto_aead_setkey'
   net/built-in.o: In function `tls_set_sw_offload':
>> (.text+0x73354): undefined reference to `crypto_aead_setauthsize'

Reported-by: kbuild test robot <fengguang.wu@intel.com>
Signed-off-by: Dave Watson <davejwatson@fb.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Thomas Bogendoerfer <tbogendoerfer@suse.de>
---
 net/tls/Kconfig |    7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

--- a/net/tls/Kconfig
+++ b/net/tls/Kconfig
@@ -4,9 +4,12 @@
 config TLS
 	tristate "Transport Layer Security support"
 	depends on INET
-	default m
+	select CRYPTO
+	select CRYPTO_AES
+	select CRYPTO_GCM
+	default n
 	---help---
 	Enable kernel support for TLS protocol. This allows symmetric
 	encryption handling of the TLS protocol to be done in-kernel.
 
-	If unsure, say M.
+	If unsure, say N.
