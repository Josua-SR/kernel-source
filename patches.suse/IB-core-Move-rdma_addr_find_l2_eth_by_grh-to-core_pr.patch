From: Parav Pandit <parav@mellanox.com>
Date: Tue, 13 Mar 2018 16:06:23 +0200
Subject: IB/core: Move rdma_addr_find_l2_eth_by_grh to core_priv.h
Patch-mainline: v4.17-rc1
Git-commit: e41a7c41947d33dbca16d1695460c121342a4601
References: bsc#1103992 FATE#326009

Before commit [1], rdma_addr_find_l2_eth_by_grh() was an exported function
and therefore declaration in include/rdma/ib_addr.h was fine.

But now that its scope is limited to ib_core module, its better to have it
in core_priv.h.

[1] commit 1060f8653414 ("IB/{core/cm}: Fix generating a return AH for
RoCEE")

Reviewed-by: Daniel Jurgens <danielj@mellanox.com>
Signed-off-by: Parav Pandit <parav@mellanox.com>
Signed-off-by: Leon Romanovsky <leon@kernel.org>
Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
Acked-by: Thomas Bogendoerfer <tbogendoerfer@suse.de>
---
 drivers/infiniband/core/core_priv.h |    5 +++++
 include/rdma/ib_addr.h              |    5 -----
 2 files changed, 5 insertions(+), 5 deletions(-)

--- a/drivers/infiniband/core/core_priv.h
+++ b/drivers/infiniband/core/core_priv.h
@@ -339,4 +339,9 @@ int rdma_resolve_ip_route(struct sockadd
 			  const struct sockaddr *dst_addr,
 			  struct rdma_dev_addr *addr);
 
+int rdma_addr_find_l2_eth_by_grh(const union ib_gid *sgid,
+				 const union ib_gid *dgid,
+				 u8 *dmac, const struct net_device *ndev,
+				 int *hoplimit);
+
 #endif /* _CORE_PRIV_H */
--- a/include/rdma/ib_addr.h
+++ b/include/rdma/ib_addr.h
@@ -129,11 +129,6 @@ int rdma_addr_size(struct sockaddr *addr
 int rdma_addr_size_in6(struct sockaddr_in6 *addr);
 int rdma_addr_size_kss(struct __kernel_sockaddr_storage *addr);
 
-int rdma_addr_find_l2_eth_by_grh(const union ib_gid *sgid,
-				 const union ib_gid *dgid,
-				 u8 *dmac, const struct net_device *ndev,
-				 int *hoplimit);
-
 static inline u16 ib_addr_get_pkey(struct rdma_dev_addr *dev_addr)
 {
 	return ((u16)dev_addr->broadcast[8] << 8) | (u16)dev_addr->broadcast[9];
