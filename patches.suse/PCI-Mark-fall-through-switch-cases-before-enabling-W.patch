From d6488ac19aabcc6c85a74b69eaf1b7301124c323 Mon Sep 17 00:00:00 2001
From: "Gustavo A. R. Silva" <gustavo@embeddedor.com>
Date: Thu, 5 Jul 2018 09:56:00 -0500
Subject: [PATCH] PCI: Mark fall-through switch cases before enabling -Wimplicit-fallthrough
Git-commit: d6488ac19aabcc6c85a74b69eaf1b7301124c323
Patch-mainline: v4.19-rc1
References: bsc#1120058

In preparation to enabling -Wimplicit-fallthrough, mark switch cases where
we are expecting to fall through.

Warning level 2 was used: -Wimplicit-fallthrough=2

Signed-off-by: Gustavo A. R. Silva <gustavo@embeddedor.com>
Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
Acked-by: Takashi Iwai <tiwai@suse.de>

---
 drivers/pci/hotplug/shpchp_ctrl.c |    2 ++
 drivers/pci/pci.c                 |    1 +
 drivers/pci/quirks.c              |    1 +
 3 files changed, 4 insertions(+)

--- a/drivers/pci/hotplug/shpchp_ctrl.c
+++ b/drivers/pci/hotplug/shpchp_ctrl.c
@@ -668,6 +668,7 @@ int shpchp_sysfs_enable_slot(struct slot
 	switch (p_slot->state) {
 	case BLINKINGON_STATE:
 		cancel_delayed_work(&p_slot->work);
+		/* fall through */
 	case STATIC_STATE:
 		p_slot->state = POWERON_STATE;
 		mutex_unlock(&p_slot->lock);
@@ -703,6 +704,7 @@ int shpchp_sysfs_disable_slot(struct slo
 	switch (p_slot->state) {
 	case BLINKINGOFF_STATE:
 		cancel_delayed_work(&p_slot->work);
+		/* fall through */
 	case STATIC_STATE:
 		p_slot->state = POWEROFF_STATE;
 		mutex_unlock(&p_slot->lock);
--- a/drivers/pci/pci.c
+++ b/drivers/pci/pci.c
@@ -1991,6 +1991,7 @@ static pci_power_t pci_target_state(stru
 		case PCI_D2:
 			if (pci_no_d1d2(dev))
 				break;
+			/* else: fall through */
 		default:
 			target_state = state;
 		}
--- a/drivers/pci/quirks.c
+++ b/drivers/pci/quirks.c
@@ -1952,6 +1952,7 @@ static void quirk_netmos(struct pci_dev
 		if (dev->subsystem_vendor == PCI_VENDOR_ID_IBM &&
 				dev->subsystem_device == 0x0299)
 			return;
+		/* else: fall through */
 	case PCI_DEVICE_ID_NETMOS_9735:
 	case PCI_DEVICE_ID_NETMOS_9745:
 	case PCI_DEVICE_ID_NETMOS_9845:
