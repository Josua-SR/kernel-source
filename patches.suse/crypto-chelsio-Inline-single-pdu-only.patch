From: Atul Gupta <atul.gupta@chelsio.com>
Date: Thu, 17 Jan 2019 09:19:19 -0800
Subject: crypto: chelsio - Inline single pdu only
Patch-mainline: v5.1-rc1
Git-commit: 27c6feb0fb33a665a746346e76714826a5be5d10
References: bsc#1136353 jsc#SLE-4688

Inline single pdu else take co-pro path

Signed-off-by: Atul Gupta <atul.gupta@chelsio.com>
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
Acked-by: Thomas Bogendoerfer <tbogendoerfer@suse.de>
---
 drivers/crypto/chelsio/chcr_ipsec.c |    3 +++
 1 file changed, 3 insertions(+)

--- a/drivers/crypto/chelsio/chcr_ipsec.c
+++ b/drivers/crypto/chelsio/chcr_ipsec.c
@@ -303,6 +303,9 @@ static bool chcr_ipsec_offload_ok(struct
 		if (ipv6_ext_hdr(ipv6_hdr(skb)->nexthdr))
 			return false;
 	}
+	/* Inline single pdu */
+	if (skb_shinfo(skb)->gso_size)
+		return false;
 	return true;
 }
 
