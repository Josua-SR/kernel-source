From 92a39be3b05a63fd3f5aae961454fc0687f942f1 Mon Sep 17 00:00:00 2001
From: Chester Lin <clin@suse.com>
Date: Fri, 30 Oct 2020 14:08:40 +0800
Subject: [PATCH 3/3] arm64/ima: add ima_arch support
References: jsc#SLE-15020
Git-repo: git://git.kernel.org/pub/scm/linux/kernel/git/efi/efi.git
Git-commit: 92a39be3b05a63fd3f5aae961454fc0687f942f1
Patch-mainline: Queued in subsystem maintainer repository

Add arm64 IMA arch support. The code and arch policy is mainly inherited
from x86.

Co-developed-by: Chester Lin <clin@suse.com>
Signed-off-by: Chester Lin <clin@suse.com>
Acked-by: Mimi Zohar <zohar@linux.ibm.com>
Signed-off-by: Ard Biesheuvel <ardb@kernel.org>
---
 arch/arm64/Kconfig |    1 +
 1 file changed, 1 insertion(+)

--- a/arch/arm64/Kconfig
+++ b/arch/arm64/Kconfig
@@ -1615,6 +1615,7 @@ config EFI
 	select EFI_RUNTIME_WRAPPERS
 	select EFI_STUB
 	select EFI_GENERIC_STUB
+	imply IMA_SECURE_AND_OR_TRUSTED_BOOT
 	default y
 	help
 	  This option provides support for runtime services provided
