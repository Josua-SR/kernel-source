From: Lucas Stach <l.stach@pengutronix.de>
Date: Fri, 17 Nov 2017 14:24:34 +0100
Subject: drm/etnaviv: remove -EAGAIN handling from submit path
Git-commit: b7b17e5cec541f58131f4a7963bbe3448f0a9c00
Patch-mainline: v4.16-rc1
References: FATE#326289 FATE#326079 FATE#326049 FATE#322398 FATE#326166

Now that the userptr BO handling doesn't rely on the userspace restarting
the submit after object population, there is no need to special case the
-EAGAIN return value anymore.

Signed-off-by: Lucas Stach <l.stach@pengutronix.de>
Reviewed-by: Philipp Zabel <p.zabel@pengutronix.de>
Acked-by: Petr Tesarik <ptesarik@suse.com>
---
 drivers/gpu/drm/etnaviv/etnaviv_gem_submit.c |    8 --------
 1 file changed, 8 deletions(-)

--- a/drivers/gpu/drm/etnaviv/etnaviv_gem_submit.c
+++ b/drivers/gpu/drm/etnaviv/etnaviv_gem_submit.c
@@ -534,14 +534,6 @@ int etnaviv_ioctl_gem_submit(struct drm_
 out:
 	submit_unpin_objects(submit);
 
-	/*
-	 * If we're returning -EAGAIN, it may be due to the userptr code
-	 * wanting to run its workqueue outside of any locks. Flush our
-	 * workqueue to ensure that it is run in a timely manner.
-	 */
-	if (ret == -EAGAIN)
-		flush_workqueue(priv->wq);
-
 err_submit_objects:
 	if (in_fence)
 		dma_fence_put(in_fence);
