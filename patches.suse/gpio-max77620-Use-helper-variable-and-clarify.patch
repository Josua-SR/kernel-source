From: Linus Walleij <linus.walleij@linaro.org>
Date: Thu, 16 Jul 2020 11:28:35 +0200
Subject: gpio: max77620: Use helper variable and clarify

Git-commit: 80606cb24161d504acb4d89f406d68f72196575e
Patch-mainline: v5.9-rc1
References: jsc#SLE-15847

Most other drivers fill out the gpio_irq_chip using a
struct gpio_irq_chip *girq helper variable for ease of
reading.

We also make a habit of explicitly assigning NULL and
zero to the parent IRQs when using ordinary IRQ handlers
in the driver, mostly for code readability and
maintenance.

Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
Reviewed-by: Dmitry Osipenko <digetx@gmail.com>
Cc: Dmitry Osipenko <digetx@gmail.com>
Link: https://lore.kernel.org/r/20200716092835.69176-1-linus.walleij@linaro.org
Signed-off-by: Mian Yousaf Kaukab <yousaf.kaukab@suse.com>
---
 drivers/gpio/gpio-max77620.c | 16 +++++++++++-----
 1 file changed, 11 insertions(+), 5 deletions(-)

diff --git a/drivers/gpio/gpio-max77620.c b/drivers/gpio/gpio-max77620.c
index e090979659eb..7c0a9ef0b500 100644
--- a/drivers/gpio/gpio-max77620.c
+++ b/drivers/gpio/gpio-max77620.c
@@ -288,6 +288,7 @@ static int max77620_gpio_probe(struct platform_device *pdev)
 {
 	struct max77620_chip *chip =  dev_get_drvdata(pdev->dev.parent);
 	struct max77620_gpio *mgpio;
+	struct gpio_irq_chip *girq;
 	unsigned int gpio_irq;
 	int ret;
 
@@ -316,11 +317,16 @@ static int max77620_gpio_probe(struct platform_device *pdev)
 	mgpio->gpio_chip.can_sleep = 1;
 	mgpio->gpio_chip.base = -1;
 
-	mgpio->gpio_chip.irq.chip = &max77620_gpio_irqchip;
-	mgpio->gpio_chip.irq.default_type = IRQ_TYPE_NONE;
-	mgpio->gpio_chip.irq.handler = handle_edge_irq;
-	mgpio->gpio_chip.irq.init_hw = max77620_gpio_irq_init_hw,
-	mgpio->gpio_chip.irq.threaded = true;
+	girq = &mgpio->gpio_chip.irq;
+	girq->chip = &max77620_gpio_irqchip;
+	/* This will let us handle the parent IRQ in the driver */
+	girq->parent_handler = NULL;
+	girq->num_parents = 0;
+	girq->parents = NULL;
+	girq->default_type = IRQ_TYPE_NONE;
+	girq->handler = handle_edge_irq;
+	girq->init_hw = max77620_gpio_irq_init_hw,
+	girq->threaded = true;
 
 	platform_set_drvdata(pdev, mgpio);
 
-- 
2.26.2

