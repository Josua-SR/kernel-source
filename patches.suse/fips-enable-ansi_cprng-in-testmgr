From: Torsten Duwe <duwe@suse.de>
Subject: crypto: allow self-test for ansi_cprng
Patch-mainline: Never, FIPS certification only.
References: bsc#1164254

FIPS-140-2 requires a self-test also for the CPRNG.
Enable it in the testmgr for fips mode.

Signed-off-by: Torsten Duwe <duwe@suse.de>

--- a/crypto/testmgr.c
+++ b/crypto/testmgr.c
@@ -3913,6 +3913,7 @@ static const struct alg_test_desc alg_te
 	}, {
 		.alg = "ansi_cprng",
 		.test = alg_test_cprng,
+		.fips_allowed = 1,
 		.suite = {
 			.cprng = __VECS(ansi_cprng_aes_tv_template)
 		}
