From: Jens Axboe <axboe@kernel.dk>
Date: Thu, 21 Nov 2019 10:16:12 -0700
Subject: [PATCH] Revert "block: split bio if the only bvec's length is >
 SZ_4K"
References: bsc#1175995,jsc#SLE-15608
Git-commit: 1e279153dfd53e76006720df804d5935a6cbc6d5
Patch-mainline: v5.5-rc1

We really don't need this, as the slow path will do the right thing
anyway.

This reverts commit 6952a7f8446ee85ea9d10ab87b64797a031eaae3.

Signed-off-by: Jens Axboe <axboe@kernel.dk>
Signed-off-by: Hannes Reinecke <hare@suse.de>
---
 block/blk-merge.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/block/blk-merge.c b/block/blk-merge.c
index 72238bc9afe9..1534ed736363 100644
--- a/block/blk-merge.c
+++ b/block/blk-merge.c
@@ -324,7 +324,7 @@ void __blk_queue_split(struct request_queue *q, struct bio **bio,
 		if (!q->limits.chunk_sectors &&
 		    (*bio)->bi_vcnt == 1 &&
 		    ((*bio)->bi_io_vec[0].bv_len +
-		     (*bio)->bi_io_vec[0].bv_offset) <= SZ_4K) {
+		     (*bio)->bi_io_vec[0].bv_offset) <= PAGE_SIZE) {
 			*nr_segs = 1;
 			break;
 		}
-- 
2.16.4

