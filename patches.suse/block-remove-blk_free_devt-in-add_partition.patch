From: weiping zhang <zhangweiping@didichuxing.com>
Date: Fri, 18 Aug 2017 23:54:46 +0800
Subject: [PATCH] block: remove blk_free_devt in add_partition
Git-commit: 47570848f0864374dec4accce68d23fc0eaac0b2
Patch-mainline: v4.14-rc1
References: bsc#1104967,FATE#325924

put_device(pdev) will call pdev->type->release finally, and blk_free_devt
has been called in part_release(), so remove it.

Signed-off-by: weiping zhang <zhangweiping@didichuxing.com>
Signed-off-by: Jens Axboe <axboe@kernel.dk>
Acked-by: Hannes Reinecke <hare@suse.com>
---
 block/partition-generic.c | 1 -
 1 file changed, 1 deletion(-)

diff --git a/block/partition-generic.c b/block/partition-generic.c
index 1745a9659517..86e8fe1adcdb 100644
--- a/block/partition-generic.c
+++ b/block/partition-generic.c
@@ -403,7 +403,6 @@ struct hd_struct *add_partition(struct gendisk *disk, int partno,
 	device_del(pdev);
 out_put:
 	put_device(pdev);
-	blk_free_devt(devt);
 	return ERR_PTR(err);
 }
 
-- 
2.16.4

