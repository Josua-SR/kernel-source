From: Hanjun Guo <guohanjun@huawei.com>
Date: Sun, 27 Sep 2020 17:55:49 +0800
Subject: ACPI: memhotplug: Remove 'state' from struct acpi_memory_device
Patch-mainline: v5.10-rc1
Git-commit: c18483a8ed30712630bc91bb9ea035cc9e1dfef0
References: jsc#SLE-16407

After commit 315bbae9c5cb ("ACPI / memhotplug: deal with eject request
in hotplug queue"), the memory device state, which is defined in
struct acpi_memory_device, is not actually useful, so remove it along
with symbols related to it.

Signed-off-by: Hanjun Guo <guohanjun@huawei.com>
[ rjw: Subject and changelog edits ]
Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Acked-by: Lee, Chun-Yi <jlee@suse.com>
---
 drivers/acpi/acpi_memhotplug.c |   12 +-----------
 1 file changed, 1 insertion(+), 11 deletions(-)

--- a/drivers/acpi/acpi_memhotplug.c
+++ b/drivers/acpi/acpi_memhotplug.c
@@ -29,11 +29,6 @@ static const struct acpi_device_id memor
 
 #ifdef CONFIG_ACPI_HOTPLUG_MEMORY
 
-/* Memory Device States */
-#define MEMORY_INVALID_STATE	0
-#define MEMORY_POWER_ON_STATE	1
-#define MEMORY_POWER_OFF_STATE	2
-
 static int acpi_memory_device_add(struct acpi_device *device,
 				  const struct acpi_device_id *not_used);
 static void acpi_memory_device_remove(struct acpi_device *device);
@@ -57,8 +52,7 @@ struct acpi_memory_info {
 };
 
 struct acpi_memory_device {
-	struct acpi_device * device;
-	unsigned int state;	/* State of the memory device */
+	struct acpi_device *device;
 	struct list_head res_list;
 };
 
@@ -226,7 +220,6 @@ static int acpi_memory_enable_device(str
 	}
 	if (!num_enabled) {
 		dev_err(&mem_device->device->dev, "add_memory failed\n");
-		mem_device->state = MEMORY_INVALID_STATE;
 		return -EINVAL;
 	}
 	/*
@@ -297,9 +290,6 @@ static int acpi_memory_device_add(struct
 		return result;
 	}
 
-	/* Set the device state */
-	mem_device->state = MEMORY_POWER_ON_STATE;
-
 	result = acpi_memory_check_device(mem_device);
 	if (result) {
 		acpi_memory_device_free(mem_device);
