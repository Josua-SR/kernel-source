From: Pavan Chebbi <pavan.chebbi@broadcom.com>
Date: Thu, 31 Oct 2019 01:07:51 -0400
Subject: bnxt_en: Call bnxt_ulp_stop()/bnxt_ulp_start() during suspend/resume.
Patch-mainline: v5.5-rc1
Git-commit: 6a68749dbd777b832e1d84265bd6d8b39d1843ac
References: jsc#SLE-8372 bsc#1153275

Inform the RDMA driver to stop/start during suspend/resume.  The
RDMA driver needs to stop and start just like error recovery.

Signed-off-by: Pavan Chebbi <pavan.chebbi@broadcom.com>
Signed-off-by: Michael Chan <michael.chan@broadcom.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Thomas Bogendoerfer <tbogendoerfer@suse.de>
---
 drivers/net/ethernet/broadcom/bnxt/bnxt.c |    2 ++
 1 file changed, 2 insertions(+)

--- a/drivers/net/ethernet/broadcom/bnxt/bnxt.c
+++ b/drivers/net/ethernet/broadcom/bnxt/bnxt.c
@@ -11899,6 +11899,7 @@ static int bnxt_suspend(struct device *d
 	int rc = 0;
 
 	rtnl_lock();
+	bnxt_ulp_stop(bp);
 	if (netif_running(dev)) {
 		netif_device_detach(dev);
 		rc = bnxt_close(dev);
@@ -11932,6 +11933,7 @@ static int bnxt_resume(struct device *de
 	}
 
 resume_exit:
+	bnxt_ulp_start(bp, rc);
 	rtnl_unlock();
 	return rc;
 }
