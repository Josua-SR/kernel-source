From 67f4fb025d8e2189f91f6ccfc8f62f76f56f889d Mon Sep 17 00:00:00 2001
From: Corey Minyard <cminyard@mvista.com>
Date: Tue, 12 Sep 2017 23:35:39 -0500
Subject: [PATCH] ipmi_si: remove ipmi_smi_alloc() function
Git-commit: 67f4fb025d8e2189f91f6ccfc8f62f76f56f889d
Patch-mainline: v4.15-rc1
References: FATE#326156

It's only used in one place now, so it's overkill.

Signed-off-by: Corey Minyard <cminyard@mvista.com>
Acked-by: Takashi Iwai <tiwai@suse.de>

---
 drivers/char/ipmi/ipmi_si_intf.c | 12 ++----------
 1 file changed, 2 insertions(+), 10 deletions(-)

diff --git a/drivers/char/ipmi/ipmi_si_intf.c b/drivers/char/ipmi/ipmi_si_intf.c
index d24cd5de09d0..3758560a6ab2 100644
--- a/drivers/char/ipmi/ipmi_si_intf.c
+++ b/drivers/char/ipmi/ipmi_si_intf.c
@@ -1302,15 +1302,6 @@ int ipmi_std_irq_setup(struct si_sm_io *io)
 	return rv;
 }
 
-static struct smi_info *smi_info_alloc(void)
-{
-	struct smi_info *info = kzalloc(sizeof(*info), GFP_KERNEL);
-
-	if (info)
-		spin_lock_init(&info->si_lock);
-	return info;
-}
-
 static int wait_for_msg_done(struct smi_info *smi_info)
 {
 	enum si_sm_result     smi_result;
@@ -1902,9 +1893,10 @@ int ipmi_si_add_smi(struct si_sm_io *io)
 		}
 	}
 
-	new_smi = smi_info_alloc();
+	new_smi = kzalloc(sizeof(*new_smi), GFP_KERNEL);
 	if (!new_smi)
 		return -ENOMEM;
+	spin_lock_init(&new_smi->si_lock);
 
 	new_smi->io = *io;
 
-- 
2.19.2

