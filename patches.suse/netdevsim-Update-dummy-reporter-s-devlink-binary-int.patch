From: Aya Levin <ayal@mellanox.com>
Date: Tue, 12 Nov 2019 14:07:51 +0200
Subject: netdevsim: Update dummy reporter's devlink binary interface
Patch-mainline: v5.5-rc1
Git-commit: 8fdcd8fb21c054217b5ca5cb627a9a726dba630f
References: bsc#1154353

Update dummy reporter's output to use updated devlink interface of
binary fmsg pair.

Signed-off-by: Aya Levin <ayal@mellanox.com>
Acked-by: Jiri Pirko <jiri@mellanox.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Thomas Bogendoerfer <tbogendoerfer@suse.de>
---
 drivers/net/netdevsim/health.c |    8 +-------
 1 file changed, 1 insertion(+), 7 deletions(-)

--- a/drivers/net/netdevsim/health.c
+++ b/drivers/net/netdevsim/health.c
@@ -82,20 +82,14 @@ static int nsim_dev_dummy_fmsg_put(struc
 	if (err)
 		return err;
 
-	err = devlink_fmsg_arr_pair_nest_start(fmsg, "test_binary");
-	if (err)
-		return err;
 	binary = kmalloc(binary_len, GFP_KERNEL);
 	if (!binary)
 		return -ENOMEM;
 	get_random_bytes(binary, binary_len);
-	err = devlink_fmsg_binary_put(fmsg, binary, binary_len);
+	err = devlink_fmsg_binary_pair_put(fmsg, "test_binary", binary, binary_len);
 	kfree(binary);
 	if (err)
 		return err;
-	err = devlink_fmsg_arr_pair_nest_end(fmsg);
-	if (err)
-		return err;
 
 	err = devlink_fmsg_pair_nest_start(fmsg, "test_nest");
 	if (err)
