From: Colin Ian King <colin.king@canonical.com>
Date: Tue, 4 Jul 2017 16:21:12 +0100
Subject: bpf: add missing break in for the TCP_BPF_SNDCWND_CLAMP case
Patch-mainline: v4.13-rc1
Git-commit: 6d3f06a0042ebd59a5e9d4ba6e8a85596901e140
References: bsc#1109837

There appears to be a missing break in the TCP_BPF_SNDCWND_CLAMP case.
Currently the non-error path where val is greater than zero falls through
to the default case that sets the error return to -EINVAL. Add in
the missing break.

Detected by CoverityScan, CID#1449376 ("Missing break in switch")

Fixes: 13bf96411ad2 ("bpf: Adds support for setting sndcwnd clamp")
Signed-off-by: Colin Ian King <colin.king@canonical.com>
Acked-by: Daniel Borkmann <daniel@iogearbox.net>
Acked-by: Lawrence Brakmo <brakmo@fb.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Thomas Bogendoerfer <tbogendoerfer@suse.de>
---
 net/core/filter.c |    1 +
 1 file changed, 1 insertion(+)

--- a/net/core/filter.c
+++ b/net/core/filter.c
@@ -2867,6 +2867,7 @@ BPF_CALL_5(bpf_setsockopt, struct bpf_so
 					tp->snd_cwnd_clamp = val;
 					tp->snd_ssthresh = val;
 				}
+				break;
 			default:
 				ret = -EINVAL;
 			}
