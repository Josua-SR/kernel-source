From: Stefan Raspl <raspl@linux.ibm.com>
Subject: net/smc: fix error return code in smc_setsockopt()
Patch-mainline: v4.18-rc1
Git-commit: 3dc9f558cdd2dfba06e021a6b85e990d1a0b2641
References: FATE#325698, LTC#167867, bsc#1113481

Summary:     net/smc: SMC-R MVP
Description: Add latest upstream patches to push SMC-R to the MVP level

Upstream-Description:

             net/smc: fix error return code in smc_setsockopt()

             Fix to return error code -EINVAL instead of 0 if optlen is invalid.

             Fixes: 01d2f7e2cdd3 ("net/smc: sockopts TCP_NODELAY and TCP_CORK")
             Signed-off-by: Wei Yongjun <weiyongjun1@huawei.com>
             Signed-off-by: David S. Miller <davem@davemloft.net>

Signed-off-by: Stefan Raspl <raspl@linux.ibm.com>
Acked-by: Petr Tesarik <ptesarik@suse.com>
---
 net/smc/af_smc.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/net/smc/af_smc.c
+++ b/net/smc/af_smc.c
@@ -1420,7 +1420,7 @@ static int smc_setsockopt(struct socket
 		return rc;
 
 	if (optlen < sizeof(int))
-		return rc;
+		return -EINVAL;
 	get_user(val, (int __user *)optval);
 
 	lock_sock(sk);
