From: Jiri Pirko <jiri@mellanox.com>
Date: Wed, 4 Sep 2019 09:40:47 +0200
Subject: rocker: add missing init_net check in FIB notifier
Patch-mainline: v5.4-rc1
Git-commit: 8330f73fe9742f201f467639f8356cf58756fb9f
References: bsc#1154353

Take only FIB events that are happening in init_net into account. No other
namespaces are supported.

Signed-off-by: Jiri Pirko <jiri@mellanox.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Thomas Bogendoerfer <tbogendoerfer@suse.de>
---
 drivers/net/ethernet/rocker/rocker_main.c |    3 +++
 1 file changed, 3 insertions(+)

--- a/drivers/net/ethernet/rocker/rocker_main.c
+++ b/drivers/net/ethernet/rocker/rocker_main.c
@@ -2189,6 +2189,9 @@ static int rocker_router_fib_event(struc
 	struct rocker_fib_event_work *fib_work;
 	struct fib_notifier_info *info = ptr;
 
+	if (!net_eq(info->net, &init_net))
+		return NOTIFY_DONE;
+
 	if (info->family != AF_INET)
 		return NOTIFY_DONE;
 
