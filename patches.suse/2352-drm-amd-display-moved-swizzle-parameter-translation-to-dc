From: Yongqiang Sun <yongqiang.sun@amd.com>
Date: Mon, 12 Dec 2016 14:20:45 -0500
Subject: drm/amd/display: Moved swizzle parameter translation to dc.
Git-commit: 88499197de090c9bb391cc11bf9410b9f020092f
Patch-mainline: v4.15-rc1
References: FATE#326289 FATE#326079 FATE#326049 FATE#322398 FATE#326166

Signed-off-by: Yongqiang Sun <yongqiang.sun@amd.com>
Reviewed-by: Tony Cheng <Tony.Cheng@amd.com>
Acked-by: Harry Wentland <Harry.Wentland@amd.com>
Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
Acked-by: Petr Tesarik <ptesarik@suse.com>
---
 drivers/gpu/drm/amd/display/dc/basics/conversion.c |    9 +++++++++
 drivers/gpu/drm/amd/display/dc/basics/conversion.h |    2 ++
 drivers/gpu/drm/amd/display/dc/dce/dce_mem_input.c |   11 +----------
 3 files changed, 12 insertions(+), 10 deletions(-)

--- a/drivers/gpu/drm/amd/display/dc/basics/conversion.c
+++ b/drivers/gpu/drm/amd/display/dc/basics/conversion.c
@@ -221,3 +221,12 @@ void calculate_adjustments_y_only(
 		adjustments->brightness);
 }
 
+unsigned int log_2(unsigned int num)
+{
+	unsigned int result = 0;
+
+	while ((num >>= 1) != 0)
+		result++;
+
+	return result;
+}
--- a/drivers/gpu/drm/amd/display/dc/basics/conversion.h
+++ b/drivers/gpu/drm/amd/display/dc/basics/conversion.h
@@ -48,4 +48,6 @@ void calculate_adjustments_y_only(
 	const struct dc_csc_adjustments *adjustments,
 	struct fixed31_32 *matrix);
 
+unsigned int log_2(unsigned int num);
+
 #endif
--- a/drivers/gpu/drm/amd/display/dc/dce/dce_mem_input.c
+++ b/drivers/gpu/drm/amd/display/dc/dce/dce_mem_input.c
@@ -25,6 +25,7 @@
 
 #include "mem_input.h"
 #include "reg_helper.h"
+#include "basics/conversion.h"
 
 #define CTX \
 	mi->ctx
@@ -129,16 +130,6 @@ static bool is_vert_scan(enum dc_rotatio
 	}
 }
 
-static unsigned int log_2(unsigned int num)
-{
-	unsigned int result = 0;
-
-	while ((num >>= 1) != 0)
-		result++;
-
-	return result;
-}
-
 void dce_mem_input_program_pte_vm(struct mem_input *mi,
 		enum surface_pixel_format format,
 		union dc_tiling_info *tiling_info,
