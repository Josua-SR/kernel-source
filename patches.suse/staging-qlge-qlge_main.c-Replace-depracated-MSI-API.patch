From: Suraj Upadhyay <usuraj35@gmail.com>
Date: Thu, 16 Jul 2020 14:28:11 +0530
Subject: staging: qlge/qlge_main.c: Replace depracated MSI API.
Patch-mainline: v5.9-rc1
Git-commit: 4eab532dca768559a7af5c82f054558c36615baf
References: jsc#SLE-15139

Replace the depracated MSI API pci_enable_msi()
with pci_alloc_irq_vectors().

Signed-off-by: Suraj Upadhyay <usuraj35@gmail.com>
Link: https://lore.kernel.org/r/20200716085811.GA29239@blackclown
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Acked-by: Shung-Hsi Yu <shung-hsi.yu@suse.com>
---
 drivers/staging/qlge/qlge_main.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/drivers/staging/qlge/qlge_main.c
+++ b/drivers/staging/qlge/qlge_main.c
@@ -3181,7 +3181,7 @@ static void ql_enable_msix(struct ql_ada
 msi:
 	qdev->intr_count = 1;
 	if (qlge_irq_type == MSI_IRQ) {
-		if (!pci_enable_msi(qdev->pdev)) {
+		if (pci_alloc_irq_vectors(qdev->pdev, 1, 1, PCI_IRQ_MSI) >= 0) {
 			set_bit(QL_MSI_ENABLED, &qdev->flags);
 			netif_info(qdev, ifup, qdev->ndev,
 				   "Running with MSI interrupts.\n");
