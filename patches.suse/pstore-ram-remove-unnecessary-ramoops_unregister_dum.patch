From: chenqiwu <chenqiwu@xiaomi.com>
Subject: pstore/ram: remove unnecessary ramoops_unregister_dummy()
Git-commit: e030b80ff4a587ba223eee8ac06df214483dba25
Patch-mainline: v5.7
References: jsc#SLE-16304
Acked-by: Jiri Bohac <jbohac@suse.cz>

Remove unnecessary ramoops_unregister_dummy() if ramoops
platform device register failed.

Signed-off-by: chenqiwu <chenqiwu@xiaomi.com>
Link: https://lore.kernel.org/r/1581068800-13817-2-git-send-email-qiwuchen55@gmail.com
Signed-off-by: Kees Cook <keescook@chromium.org>

diff --git a/fs/pstore/ram.c b/fs/pstore/ram.c
index 013486b5125e..795622190c01 100644
--- a/fs/pstore/ram.c
+++ b/fs/pstore/ram.c
@@ -963,7 +963,6 @@ static void __init ramoops_register_dummy(void)
 		pr_info("could not create platform device: %ld\n",
 			PTR_ERR(dummy));
 		dummy = NULL;
-		ramoops_unregister_dummy();
 	}
 }
 
-- 
2.28.0

