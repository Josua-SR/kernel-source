From: Jason Gunthorpe <jgg@mellanox.com>
Date: Wed, 15 Aug 2018 16:52:58 -0600
Subject: Revert "net/smc: Replace ib_query_gid with rdma_get_gid_attr"
Git-commit: 92f4e77c85918eab5e5803d7e28ab89a7e6bd3a2
Patch-mainline: v4.19-rc1
References: FATE#325698, LTC#167867, bsc#1113481

This reverts commit ddb457c6993babbcdd41fca638b870d2a2fc3941.

The include rdma/ib_cache.h is kept, and we have to add a memset
to the compat wrapper to avoid compiler warnings in gcc-7

This revert is done to avoid extensive merge conflicts with SMC
changes in netdev during the 4.19 merge window.

Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
[Petr: partly squashed with ddb457c6993babbcdd41fca638b870d2a2fc3941.]
Signed-off-by: Petr Tesarik <ptesarik@suse.com>
---
 include/rdma/ib_cache.h |    1 +
 1 file changed, 1 insertion(+)

--- a/include/rdma/ib_cache.h
+++ b/include/rdma/ib_cache.h
@@ -143,6 +143,7 @@ static inline __deprecated int ib_query_
 {
 	const struct ib_gid_attr *attr;
 
+	memset(attr_out, 0, sizeof(*attr_out));
 	attr = rdma_get_gid_attr(device, port_num, index);
 	if (IS_ERR(attr))
 		return PTR_ERR(attr);
