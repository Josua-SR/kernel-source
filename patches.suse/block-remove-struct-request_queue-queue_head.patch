From: Junxiao Bi <junxiao.bi@oracle.com>
Date: Fri, 16 Aug 2019 14:12:33 -0700
Subject: [PATCH] block: remove struct request_queue queue_head
References: bsc#1156419,jsc#SLE-8281
Git-commit: 988721db93b2f5e6477cb0ea0b64ba9bcfd67778
Patch-mainline: v5.4-rc1

The dispatch list is not used any more, as the legacy block IO stack
has been removed.

Reviewed-by: Bart Van Assche <bvanassche@acm.org>
Reviewed-by: Ming Lei <ming.lei@redhat.com>
Signed-off-by: Junxiao Bi <junxiao.bi@oracle.com>
Signed-off-by: Jens Axboe <axboe@kernel.dk>
Signed-off-by: Hannes Reinecke <hare@suse.de>
---
 block/blk-core.c       | 1 -
 include/linux/blkdev.h | 4 ----
 2 files changed, 5 deletions(-)

diff --git a/block/blk-core.c b/block/blk-core.c
index 834aea04718f..5d0d7441a443 100644
--- a/block/blk-core.c
+++ b/block/blk-core.c
@@ -482,7 +482,6 @@ struct request_queue *blk_alloc_queue_node(gfp_t gfp_mask, int node_id)
 	if (!q)
 		return NULL;
 
-	INIT_LIST_HEAD(&q->queue_head);
 	q->last_merge = NULL;
 
 	q->id = ida_simple_get(&blk_queue_ida, 0, 0, gfp_mask);
diff --git a/include/linux/blkdev.h b/include/linux/blkdev.h
index 1e463098fac8..0eb5e54d2b2f 100644
--- a/include/linux/blkdev.h
+++ b/include/linux/blkdev.h
@@ -394,10 +394,6 @@ static inline int blkdev_reset_zones_ioctl(struct block_device *bdev,
 #endif /* CONFIG_BLK_DEV_ZONED */
 
 struct request_queue {
-	/*
-	 * Together with queue_head for cacheline sharing
-	 */
-	struct list_head	queue_head;
 	struct request		*last_merge;
 	struct elevator_queue	*elevator;
 
-- 
2.16.4

