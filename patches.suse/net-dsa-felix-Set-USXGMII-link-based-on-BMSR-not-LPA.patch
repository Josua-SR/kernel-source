From: Alex Marginean <alexandru.marginean@nxp.com>
Date: Thu, 16 Jan 2020 20:05:06 +0200
Subject: net: dsa: felix: Set USXGMII link based on BMSR, not LPA

Git-commit: 062a33b1ad7c8df9f8f03f7b01c18e31a794a01d
Patch-mainline: v5.6-rc1
References: jsc#SLE-9263

At least some PHYs (AQR412) don't advertise copper-side link status
during system side AN.

So remove this duplicate assignment to pcs->link and rely on the
previous one for link state: the local indication from the MAC PCS.

Fixes: bdeced75b13f ("net: dsa: felix: Add PCS operations for PHYLINK")
Signed-off-by: Alex Marginean <alexandru.marginean@nxp.com>
Signed-off-by: Vladimir Oltean <vladimir.oltean@nxp.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Mian Yousaf Kaukab <yousaf.kaukab@suse.com>
---
 drivers/net/dsa/ocelot/felix_vsc9959.c | 1 -
 1 file changed, 1 deletion(-)

diff --git a/drivers/net/dsa/ocelot/felix_vsc9959.c b/drivers/net/dsa/ocelot/felix_vsc9959.c
index 03482616faa7..1e82b0d72058 100644
--- a/drivers/net/dsa/ocelot/felix_vsc9959.c
+++ b/drivers/net/dsa/ocelot/felix_vsc9959.c
@@ -892,7 +892,6 @@ static void vsc9959_pcs_link_state_usxgmii(struct phy_device *pcs,
 		break;
 	}
 
-	pcs->link = USXGMII_LPA_LNKS(lpa);
 	if (USXGMII_LPA_DUPLEX(lpa))
 		pcs->duplex = DUPLEX_FULL;
 	else
-- 
2.16.4

