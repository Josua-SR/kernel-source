Subject: sched: Provide boot option to disable sched_rt_runtime
From: Jack Steiner <steiner@sgi.com>
Date: Wed Aug  2 10:55:41 CEST 2017
Patch-mainline: Never, RT specific
References: SLE Realtime Extension

Very large machines may livelock due to scalability issues, so give the
user the ability to boot time disable realtime bandwidth control.

Signed-off-by: Mike Galbraith <mgalbraith@suse.de>
---
 Documentation/admin-guide/kernel-parameters.txt |    2 ++
 kernel/sched/core.c                             |   11 +++++++++++
 2 files changed, 13 insertions(+)

--- a/Documentation/admin-guide/kernel-parameters.txt
+++ b/Documentation/admin-guide/kernel-parameters.txt
@@ -2675,6 +2675,8 @@
 	noresume	[SWSUSP] Disables resume and restores original swap
 			space.
 
+	nortsched       [KNL] Disables realtime task bandwidth control.
+
 	no-scroll	[VGA] Disables scrollback.
 			This is required for the Braillex ib80-piezo Braille
 			reader made by F.H. Papenmeier (Germany).
--- a/kernel/sched/core.c
+++ b/kernel/sched/core.c
@@ -7679,3 +7679,14 @@ void migrate_enable(void)
 }
 EXPORT_SYMBOL(migrate_enable);
 #endif
+
+/*
+ * Bootline option to disable sched_rt_runtime.  Otherwise very large
+ * systems may livelock during boot.
+ */
+static int __init parse_nortsched(char *arg)
+{
+	sysctl_sched_rt_runtime = -1;
+	return 0;
+}
+early_param("nortsched", parse_nortsched);
