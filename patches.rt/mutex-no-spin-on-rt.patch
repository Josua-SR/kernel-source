From: Thomas Gleixner <tglx@linutronix.de>
Date: Sun, 17 Jul 2011 21:51:45 +0200
Subject: locking: Disable spin on owner for RT
Git-repo: git://git.kernel.org/pub/scm/linux/kernel/git/wagi/linux-stable-rt.git
Git-commit: 13c55ca261a83662525da24584c8f67b8ce8881c
Patch-mainline: Queued in subsystem maintainer repository
References: SLE Realtime Extension

Drop spin on owner for mutex / rwsem. We are most likely not using it
butâ€¦

Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
Signed-off-by: Daniel Wagner <dwagner@suse.de>
---
 kernel/Kconfig.locks |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

--- a/kernel/Kconfig.locks
+++ b/kernel/Kconfig.locks
@@ -226,11 +226,11 @@ config ARCH_SUPPORTS_ATOMIC_RMW
 
 config MUTEX_SPIN_ON_OWNER
 	def_bool y
-	depends on SMP && ARCH_SUPPORTS_ATOMIC_RMW
+	depends on SMP && ARCH_SUPPORTS_ATOMIC_RMW && !PREEMPT_RT
 
 config RWSEM_SPIN_ON_OWNER
        def_bool y
-       depends on SMP && ARCH_SUPPORTS_ATOMIC_RMW
+       depends on SMP && ARCH_SUPPORTS_ATOMIC_RMW  && !PREEMPT_RT
 
 config LOCK_SPIN_ON_OWNER
        def_bool y
