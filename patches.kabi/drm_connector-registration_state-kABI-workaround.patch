From: Takashi Iwai <tiwai@suse.de>
Subject: kABI workaround for drm_connector.registered type changes
Patch-mainline: Never, kABI workaround
References: bsc#1111666

The patch drm-atomic_helper-Stop-modesets-on-unregistered-conn.patch
changed the struct field drm_connector.registered, which breaks kABI.
Restore it with a standard __GENKSYMS__ hack.

Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 include/drm/drm_connector.h |    8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

--- a/include/drm/drm_connector.h
+++ b/include/drm/drm_connector.h
@@ -904,7 +904,13 @@ struct drm_connector {
 	 *
 	 * Protected by @mutex.
 	 */
-	enum drm_connector_registration_state registration_state;
+#ifdef __GENKSYMS__
+	bool registered;
+#else
+	/* FIXME: using unsigned char to make sure the size alignment with bool above */
+	/* enum drm_connector_registration_state registration_state; */
+	unsigned char registration_state;
+#endif
 
 	/**
 	 * @modes:
